---
title: "Spotify and YouTube Music Data Analysis Project"
author: "Mitchell Hang & Olivia Janik"
date: "4/14/23"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction 

In this notebook, we are analyzing a dataset which features statistics for the top 10 songs of various artists on Spotify and their corresponding YouTube videos. (https://www.kaggle.com/datasets/salvatorerastelli/spotify-and-youtube)

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(janitor)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data. 
The Spotify and Youtube data has 20,718 observations of 28 variables. The main variables we will be working with in this data are number of streams, danceability, valence, key, and views on Youtube. After looking more closely at the data, we believe that we will be able to answer all of the questions we posed in the previous milestone. There were 1,655 songs with NA in at least one of their columns so we removed them from the data set for simplification.

```{r}
# Load required data

# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 

Spotify_Youtube <- read_csv("data/Spotify_Youtube.csv")

Spotify_Youtube_clean <- Spotify_Youtube %>%
  clean_names() %>%
  drop_na()


```

## Questions to Analyze
In this notebook, we are using data analysis to answer five newsworthy questions.

### Question 1

* **Question text**: What is the correlation between a song’s “danceability” and its number of streams?
* **Analysis summary**: When we asked this question, our original hypothesis was that songs with high danceability would have more streams. However, after filtering the data to only show the columns we needed to answer this question and plotting the 100 most streamed songs with the number of streams and their danceability score in a scatter plot, we discovered that there is not a strong relationship between danceability and number of streams once a song hits a certain level of danceability. We think it is worth noting that the lowest danceability score in the top 100 streamed songs is 0.351, but after that there is no clear pattern.

```{r}
Spotify_Youtube_clean_Q1 <- Spotify_Youtube_clean %>%
arrange(desc(stream)) %>%
  mutate(stream_in_billions = (stream/1000000000)) %>%
    slice(1:100) %>%
  summarize(artist, track, danceability, stream, stream_in_billions)

Spotify_Youtube_clean_Q1 %>%
 ggplot() +
   geom_point(aes(x=danceability, y=stream_in_billions)) +
    xlim(0,1) +
     theme_minimal() +
    
    labs(
    title="No apparent relationship between number of streams and song's danceability",
    x = "Danceability",
    y = "Number of Spotify streams in billions",
    caption = "Source: Kaggle"
    
  )

# Display results of code below this codeblock

```

### Question 2

* **Question text**: What mood of song gets more streams, happy songs (0.8 valence or higher) or sad songs (0.2 valence or lower)?
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Question 3

* **Question text**: What is the correlation between a song’s key and its valence? Do certain keys register positive emotions while others register negative emotions?
* **Analysis summary**: [Write up two to three sentences describing the results of your analysis.  Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Question 4

* **Question text**: What artist has the most songs in the top 100 most streamed songs on Spotify?
* **Analysis summary**: The artist who has the most songs in the top 100 most streamed songs on Spotify is Post Malone, with five songs: "rockstar (feat. 21 Savage)," "Sunflower - Spider-Man: Into the Spider-Verse," "Circles," "Better Now" and "Congratulations."

```{r}
# Put code to reverse engineer sentence here

Spotify_Youtube_clean %>%
  arrange(desc(stream)) %>%
  slice(1:100) %>%
  group_by(artist) %>%
  summarize(total_songs = n()) %>%
  arrange(desc(total_songs))

# Display results of code below this codeblock

```

### Question 5

* **Question text**: Which song has the largest difference between Spotify streams and Youtube views from its official video. 
* **Analysis summary**: "Despacito" by Luis Fonsi feat. Daddy Yankee has the largest difference between Spotify streams and YouTube views, with a difference of more than 6.5 billion, nearly 2 billion more than the difference of the song on the list. The official video for "Despacito" was once the most viewed YouTube video ever, so it makes sense as to why the difference in streams and views is so large. The only artist to have two songs in the top 10 largest differences was CoComelon, a children's music YouTube channel. 

```{r}
# Put code to reverse engineer sentence here

Spotify_Youtube_clean %>%
  filter(official_video = TRUE) %>%
  mutate(difference = abs(views - stream)) %>%
  arrange(desc(difference)) %>%
  summarize(artist, track, views, stream, difference)

# Display results of code below this codeblock

```

-30-